{
  "$defs": {
    "Backoff": {
      "description": "Retry backoff strategy for failed operations.\n\n- fixed: Same delay between retries\n- exponential: Delay doubles each retry\n- linear: Delay increases by fixed amount\n- fibonacci: Delay follows Fibonacci sequence",
      "enum": [
        "fixed",
        "exponential",
        "linear",
        "fibonacci"
      ],
      "title": "Backoff",
      "type": "string"
    },
    "CompensationSpec": {
      "properties": {
        "action": {
          "description": "Compensation action",
          "title": "Action",
          "type": "string"
        },
        "idempotent": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether compensation is idempotent",
          "title": "Idempotent"
        },
        "step": {
          "description": "Step to compensate",
          "title": "Step",
          "type": "string"
        }
      },
      "required": [
        "step",
        "action"
      ],
      "title": "CompensationSpec",
      "type": "object"
    },
    "EventBusSpec": {
      "properties": {
        "async_dispatch": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether dispatch is async",
          "title": "Async Dispatch"
        },
        "at_least_once": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "At-least-once delivery",
          "title": "At Least Once"
        },
        "at_most_once": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "At-most-once delivery",
          "title": "At Most Once"
        },
        "event_sourcing": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether event sourcing is supported",
          "title": "Event Sourcing"
        },
        "exactly_once": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Exactly-once delivery",
          "title": "Exactly Once"
        },
        "guaranteed_delivery": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether delivery is guaranteed",
          "title": "Guaranteed Delivery"
        },
        "ordering_guarantee": {
          "anyOf": [
            {
              "$ref": "#/$defs/OrderingGuarantee"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Ordering guarantee level"
        },
        "transactional_outbox": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether transactional outbox pattern is supported",
          "title": "Transactional Outbox"
        },
        "type": {
          "anyOf": [
            {
              "$ref": "#/$defs/EventBusType"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Event bus type"
        }
      },
      "title": "EventBusSpec",
      "type": "object"
    },
    "EventBusType": {
      "description": "Event bus/message broker implementation.\n\n- in_memory: Local in-process event bus\n- redis: Redis Pub/Sub or Streams\n- rabbitmq: RabbitMQ/AMQP\n- kafka: Apache Kafka\n- sqs: AWS SQS\n- pubsub: Google Cloud Pub/Sub\n- nats: NATS messaging\n- custom: Custom implementation",
      "enum": [
        "in_memory",
        "redis",
        "rabbitmq",
        "kafka",
        "sqs",
        "pubsub",
        "nats",
        "custom"
      ],
      "title": "EventBusType",
      "type": "string"
    },
    "EventCategory": {
      "description": "Category of event for routing and handling.\n\n- domain: Core business domain events\n- integration: Cross-system integration events\n- notification: User-facing notifications\n- system: Infrastructure/operational events\n- command: Request to perform an action\n- query: Request for information",
      "enum": [
        "domain",
        "integration",
        "notification",
        "system",
        "command",
        "query"
      ],
      "title": "EventCategory",
      "type": "string"
    },
    "EventFieldSpec": {
      "properties": {
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "name": {
          "description": "Field name",
          "minLength": 1,
          "title": "Name",
          "type": "string"
        },
        "required": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": true,
          "description": "Whether field is required",
          "title": "Required"
        },
        "type": {
          "description": "Field type",
          "title": "Type",
          "type": "string"
        }
      },
      "required": [
        "name",
        "type"
      ],
      "title": "EventFieldSpec",
      "type": "object"
    },
    "EventFilterSpec": {
      "properties": {
        "field": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Field to filter on",
          "title": "Field"
        },
        "operator": {
          "anyOf": [
            {
              "$ref": "#/$defs/Operator"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Filter operator"
        },
        "value": {
          "anyOf": [
            {},
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Filter value",
          "title": "Value"
        }
      },
      "title": "EventFilterSpec",
      "type": "object"
    },
    "EventSpec": {
      "properties": {
        "category": {
          "anyOf": [
            {
              "$ref": "#/$defs/EventCategory"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Event category"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "idempotency_key": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Field used for idempotency",
          "title": "Idempotency Key"
        },
        "metadata": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/EventFieldSpec"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Standard metadata fields",
          "title": "Metadata"
        },
        "name": {
          "description": "Event type name",
          "minLength": 1,
          "title": "Name",
          "type": "string"
        },
        "ordering_key": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Field used for ordering",
          "title": "Ordering Key"
        },
        "payload": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/EventFieldSpec"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Event payload fields",
          "title": "Payload"
        },
        "topic": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Default topic/channel",
          "title": "Topic"
        },
        "ttl": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Event time-to-live",
          "title": "Ttl"
        },
        "type": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Event class reference",
          "title": "Type"
        },
        "version": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Event schema version",
          "title": "Version"
        }
      },
      "required": [
        "name"
      ],
      "title": "EventSpec",
      "type": "object"
    },
    "EventsLibraryFields": {
      "properties": {
        "event_bus": {
          "anyOf": [
            {
              "$ref": "#/$defs/EventBusSpec"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "events": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/EventSpec"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Event type definitions",
          "title": "Events"
        },
        "handlers": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/HandlerSpec"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Event handler definitions",
          "title": "Handlers"
        },
        "sagas": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/SagaSpec"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Saga/process manager definitions",
          "title": "Sagas"
        },
        "topics": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/TopicSpec"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Topic/channel definitions",
          "title": "Topics"
        }
      },
      "title": "EventsLibraryFields",
      "type": "object"
    },
    "EventsMethodFields": {
      "properties": {
        "emits": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Events this method emits",
          "title": "Emits"
        },
        "triggers_on": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Events that trigger this method",
          "title": "Triggers On"
        }
      },
      "title": "EventsMethodFields",
      "type": "object"
    },
    "EventsTypeFields": {
      "properties": {
        "domain_events": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether this is a domain event aggregate",
          "title": "Domain Events"
        },
        "emits": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Events this type emits",
          "title": "Emits"
        },
        "handles": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Events this type handles",
          "title": "Handles"
        }
      },
      "title": "EventsTypeFields",
      "type": "object"
    },
    "HandlerSpec": {
      "properties": {
        "async": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether handler is async",
          "title": "Async"
        },
        "concurrency": {
          "anyOf": [
            {
              "minimum": 1,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Max concurrent executions",
          "title": "Concurrency"
        },
        "dead_letter": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Dead letter topic on failure",
          "title": "Dead Letter"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "filters": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/EventFilterSpec"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Event filters",
          "title": "Filters"
        },
        "function": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Handler function reference",
          "title": "Function"
        },
        "handles": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Events this handler processes",
          "title": "Handles"
        },
        "idempotent": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether handler is idempotent",
          "title": "Idempotent"
        },
        "name": {
          "description": "Handler name",
          "minLength": 1,
          "title": "Name",
          "type": "string"
        },
        "ordering": {
          "anyOf": [
            {
              "$ref": "#/$defs/Ordering"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Event ordering guarantee"
        },
        "retry": {
          "anyOf": [
            {
              "$ref": "#/$defs/RetrySpec"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "timeout": {
          "anyOf": [
            {
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Handler timeout in seconds",
          "title": "Timeout"
        }
      },
      "required": [
        "name"
      ],
      "title": "HandlerSpec",
      "type": "object"
    },
    "OnFailure": {
      "description": "How saga steps handle failures.\n\n- compensate: Run compensation actions\n- retry: Retry the failed step\n- skip: Skip and continue to next step\n- abort: Abort the entire saga",
      "enum": [
        "compensate",
        "retry",
        "skip",
        "abort"
      ],
      "title": "OnFailure",
      "type": "string"
    },
    "Operator": {
      "description": "Comparison operators for event filtering.\n\nStandard comparison and pattern matching operators.",
      "enum": [
        "eq",
        "neq",
        "gt",
        "gte",
        "lt",
        "lte",
        "in",
        "contains",
        "regex"
      ],
      "title": "Operator",
      "type": "string"
    },
    "Ordering": {
      "description": "Event ordering guarantee for handlers.\n\n- none: No ordering guarantee\n- fifo: First-in, first-out global ordering\n- partition_fifo: FIFO within partition key",
      "enum": [
        "none",
        "fifo",
        "partition_fifo"
      ],
      "title": "Ordering",
      "type": "string"
    },
    "OrderingGuarantee": {
      "description": "Message ordering guarantee level.\n\n- none: No ordering guarantees\n- per_partition: Ordering within partition key\n- global_: Total ordering across all messages",
      "enum": [
        "none",
        "per_partition",
        "global"
      ],
      "title": "OrderingGuarantee",
      "type": "string"
    },
    "Persistence": {
      "description": "Where saga/process state is persisted.\n\n- in_memory: No persistence (lost on restart)\n- database: Traditional database storage\n- event_store: Event sourcing storage",
      "enum": [
        "in_memory",
        "database",
        "event_store"
      ],
      "title": "Persistence",
      "type": "string"
    },
    "RetrySpec": {
      "properties": {
        "backoff": {
          "anyOf": [
            {
              "$ref": "#/$defs/Backoff"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Backoff strategy"
        },
        "initial_delay": {
          "anyOf": [
            {
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Initial delay in seconds",
          "title": "Initial Delay"
        },
        "jitter": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether to add jitter",
          "title": "Jitter"
        },
        "max_attempts": {
          "anyOf": [
            {
              "minimum": 1,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Maximum retry attempts",
          "title": "Max Attempts"
        },
        "max_delay": {
          "anyOf": [
            {
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Maximum delay in seconds",
          "title": "Max Delay"
        },
        "retryable_exceptions": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Exceptions that trigger retry",
          "title": "Retryable Exceptions"
        }
      },
      "title": "RetrySpec",
      "type": "object"
    },
    "SagaSpec": {
      "properties": {
        "compensations": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/CompensationSpec"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Compensation actions",
          "title": "Compensations"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "name": {
          "description": "Saga name",
          "minLength": 1,
          "title": "Name",
          "type": "string"
        },
        "persistence": {
          "anyOf": [
            {
              "$ref": "#/$defs/Persistence"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "State persistence strategy"
        },
        "starts_with": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Events that start this saga",
          "title": "Starts With"
        },
        "steps": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/SagaStepSpec"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Saga steps",
          "title": "Steps"
        },
        "timeout": {
          "anyOf": [
            {
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Saga timeout in seconds",
          "title": "Timeout"
        },
        "type": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Saga class reference",
          "title": "Type"
        }
      },
      "required": [
        "name"
      ],
      "title": "SagaSpec",
      "type": "object"
    },
    "SagaStepSpec": {
      "properties": {
        "action": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Action to perform (command/event)",
          "title": "Action"
        },
        "name": {
          "description": "Step name",
          "minLength": 1,
          "title": "Name",
          "type": "string"
        },
        "on_failure": {
          "anyOf": [
            {
              "$ref": "#/$defs/OnFailure"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Failure handling"
        },
        "timeout": {
          "anyOf": [
            {
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Step timeout in seconds",
          "title": "Timeout"
        },
        "wait_for": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Events to wait for",
          "title": "Wait For"
        }
      },
      "required": [
        "name"
      ],
      "title": "SagaStepSpec",
      "type": "object"
    },
    "TopicSpec": {
      "properties": {
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "events": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Event types published to this topic",
          "title": "Events"
        },
        "name": {
          "description": "Topic name",
          "minLength": 1,
          "title": "Name",
          "type": "string"
        },
        "partitions": {
          "anyOf": [
            {
              "minimum": 1,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Number of partitions",
          "title": "Partitions"
        },
        "pattern": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Topic pattern (for wildcards)",
          "title": "Pattern"
        },
        "retention": {
          "anyOf": [
            {
              "minLength": 2,
              "pattern": "^[0-9]+(ms|s|m|h|d)$",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Message retention period",
          "title": "Retention"
        },
        "subscribers": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Subscriber handler names",
          "title": "Subscribers"
        }
      },
      "required": [
        "name"
      ],
      "title": "TopicSpec",
      "type": "object"
    }
  },
  "$id": "https://libspec.dev/schema/1.0/extensions/events.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "Extension for event-driven architecture specifications.",
  "title": "Events Extension"
}

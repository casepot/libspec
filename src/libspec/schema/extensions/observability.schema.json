{
  "$defs": {
    "DebugToolsSpec": {
      "properties": {
        "async_debug": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether async debugging tools are available",
          "title": "Async Debug"
        },
        "memory_tracking": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether memory tracking is available",
          "title": "Memory Tracking"
        },
        "profiling_supported": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether profiling hooks are available",
          "title": "Profiling Supported"
        },
        "repr_depth": {
          "anyOf": [
            {
              "exclusiveMinimum": 0,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Default __repr__ recursion depth",
          "title": "Repr Depth"
        },
        "sensitive_fields": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Fields redacted in debug output",
          "title": "Sensitive Fields"
        },
        "trace_format": {
          "anyOf": [
            {
              "$ref": "#/$defs/TraceFormat"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Trace output format"
        }
      },
      "title": "DebugToolsSpec",
      "type": "object"
    },
    "HealthCheckSpec": {
      "properties": {
        "dependencies": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Dependencies checked",
          "title": "Dependencies"
        },
        "endpoint": {
          "anyOf": [
            {
              "minLength": 1,
              "pattern": "^/.*$",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "HTTP endpoint path",
          "title": "Endpoint"
        },
        "interval": {
          "anyOf": [
            {
              "exclusiveMinimum": 0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Check interval in seconds",
          "title": "Interval"
        },
        "method": {
          "anyOf": [
            {
              "minLength": 1,
              "pattern": "^_{0,2}[a-z][a-z0-9_]*_{0,2}$",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Method to call for health check",
          "title": "Method"
        },
        "name": {
          "description": "Health check name",
          "minLength": 1,
          "title": "Name",
          "type": "string"
        },
        "timeout": {
          "anyOf": [
            {
              "exclusiveMinimum": 0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Timeout in seconds",
          "title": "Timeout"
        },
        "type": {
          "$ref": "#/$defs/HealthCheckType",
          "description": "Health check type"
        }
      },
      "required": [
        "name",
        "type"
      ],
      "title": "HealthCheckSpec",
      "type": "object"
    },
    "HealthCheckType": {
      "description": "Kubernetes-style health check type.\n\n- liveness: Is the application alive? Failure triggers restart\n- readiness: Can the application handle traffic? Failure removes from LB\n- startup: Has the application started? Protects slow-starting apps",
      "enum": [
        "liveness",
        "readiness",
        "startup"
      ],
      "title": "HealthCheckType",
      "type": "string"
    },
    "LogLevel": {
      "description": "Standard Python logging levels.\n\nMember names and values are lowercase for consistency with other enums\nin libspec. Python's logging module uses uppercase level names internally.",
      "enum": [
        "debug",
        "info",
        "warning",
        "error",
        "critical"
      ],
      "title": "LogLevel",
      "type": "string"
    },
    "LoggingSpec": {
      "properties": {
        "context_fields": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Context fields included in log entries",
          "title": "Context Fields"
        },
        "levels_used": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/LogLevel"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Log levels used",
          "title": "Levels Used"
        },
        "logger_name": {
          "anyOf": [
            {
              "minLength": 1,
              "pattern": "^[a-z][a-z0-9_]*(\\.[a-z][a-z0-9_]*)*$",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Logger name (e.g., 'mylib')",
          "title": "Logger Name"
        },
        "rate_limiting": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether log rate limiting is supported",
          "title": "Rate Limiting"
        },
        "sampling": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether log sampling is supported",
          "title": "Sampling"
        },
        "sensitive_fields": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Fields that are masked in logs",
          "title": "Sensitive Fields"
        },
        "structured": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Whether structured logging is used",
          "title": "Structured"
        }
      },
      "title": "LoggingSpec",
      "type": "object"
    },
    "MetricSpec": {
      "properties": {
        "buckets": {
          "anyOf": [
            {
              "items": {
                "minimum": 0.0,
                "type": "number"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Histogram buckets (for histogram type)",
          "title": "Buckets"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "What this metric measures",
          "title": "Description"
        },
        "labels": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Label names for this metric",
          "title": "Labels"
        },
        "name": {
          "description": "Metric name (e.g., 'mylib_requests_total')",
          "minLength": 1,
          "pattern": "^[a-z_][a-z0-9_]*$",
          "title": "Name",
          "type": "string"
        },
        "type": {
          "$ref": "#/$defs/MetricType",
          "description": "Metric type"
        },
        "unit": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Unit of measurement (e.g., 'seconds', 'bytes')",
          "title": "Unit"
        }
      },
      "required": [
        "name",
        "type"
      ],
      "title": "MetricSpec",
      "type": "object"
    },
    "MetricType": {
      "description": "Prometheus-style metric types.\n\n- counter: Monotonically increasing value (e.g., request count)\n- gauge: Value that can go up or down (e.g., temperature)\n- histogram: Distribution of values in buckets (e.g., latencies)\n- summary: Distribution with quantiles (e.g., latency percentiles)\n- info: Informational metric with labels only",
      "enum": [
        "counter",
        "gauge",
        "histogram",
        "summary",
        "info"
      ],
      "title": "MetricType",
      "type": "string"
    },
    "ObservabilityLibraryFields": {
      "properties": {
        "debug_tools": {
          "anyOf": [
            {
              "$ref": "#/$defs/DebugToolsSpec"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "health_checks": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/HealthCheckSpec"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Health check endpoints",
          "title": "Health Checks"
        },
        "logging": {
          "anyOf": [
            {
              "$ref": "#/$defs/LoggingSpec"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "metrics": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/MetricSpec"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Metrics exposed by the library",
          "title": "Metrics"
        },
        "tracing": {
          "anyOf": [
            {
              "$ref": "#/$defs/TracingSpec"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        }
      },
      "title": "ObservabilityLibraryFields",
      "type": "object"
    },
    "Propagation": {
      "description": "Distributed tracing context propagation format.\n\n- w3c: W3C Trace Context (standard)\n- b3: Zipkin B3 format\n- jaeger: Jaeger native format\n- xray: AWS X-Ray format\n- datadog: Datadog APM format\n- custom: Custom propagation implementation",
      "enum": [
        "w3c",
        "b3",
        "jaeger",
        "xray",
        "datadog",
        "custom"
      ],
      "title": "Propagation",
      "type": "string"
    },
    "Sampling": {
      "description": "Trace sampling strategy.\n\n- always: Sample every trace\n- never: Never sample (disable tracing)\n- probabilistic: Sample based on probability (e.g., 10%)\n- rate_limited: Sample up to N traces per second\n- parent_based: Follow parent span's sampling decision",
      "enum": [
        "always",
        "never",
        "probabilistic",
        "rate_limited",
        "parent_based"
      ],
      "title": "Sampling",
      "type": "string"
    },
    "TraceFormat": {
      "description": "Debug trace output format.\n\n- json: Machine-readable JSON format\n- text: Plain text format\n- compact: Minimal output format\n- pretty: Human-readable formatted output",
      "enum": [
        "json",
        "text",
        "compact",
        "pretty"
      ],
      "title": "TraceFormat",
      "type": "string"
    },
    "TracingSpec": {
      "properties": {
        "attributes": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Standard span attributes",
          "title": "Attributes"
        },
        "baggage": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Baggage items propagated",
          "title": "Baggage"
        },
        "events": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Span events emitted",
          "title": "Events"
        },
        "propagation": {
          "anyOf": [
            {
              "$ref": "#/$defs/Propagation"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Context propagation format"
        },
        "sampling": {
          "anyOf": [
            {
              "$ref": "#/$defs/Sampling"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Sampling strategy"
        },
        "sampling_rate": {
          "anyOf": [
            {
              "maximum": 1.0,
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Sampling rate (0.0-1.0)",
          "title": "Sampling Rate"
        },
        "span_names": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Span names used",
          "title": "Span Names"
        }
      },
      "title": "TracingSpec",
      "type": "object"
    }
  },
  "$id": "https://libspec.dev/schema/1.0/extensions/observability.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "Extension for logging, metrics, and tracing specifications.",
  "title": "Observability Extension"
}
